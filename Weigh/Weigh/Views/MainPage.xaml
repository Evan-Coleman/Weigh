<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:linear="clr-namespace:Syncfusion.SfGauge.XForms;assembly=Syncfusion.SfGauge.XForms"
             xmlns:localization="clr-namespace:Weigh.Localization;assembly=Weigh"
             xmlns:microcharts="clr-namespace:Microcharts.Forms;assembly=Microcharts.Forms" 
             xmlns:controls="clr-namespace:Weigh.Controls;assembly=Weigh"
             x:Class="Weigh.Views.MainPage"
             Title="{Binding Title}">

    <Grid RowSpacing="0" Padding="0,3,0,0">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height=".4*" />
            <RowDefinition Height=".1*" />
            <RowDefinition Height=".2*" />
            <RowDefinition Height=".4*" />
            <RowDefinition Height="50" />
        </Grid.RowDefinitions>

        <!-- Weight Left Chart Region -->
            <Grid Grid.Column="0" Grid.Row="0" Margin="0" Padding="0" BackgroundColor="Transparent">
                <Grid.RowDefinitions>
                    <RowDefinition Height=".14*" />
                    <RowDefinition Height=".74*" />
                    <RowDefinition Height=".14*" />
                </Grid.RowDefinitions>
                <Label Grid.Row="0"
                       VerticalOptions="End"
                       HorizontalOptions="Center"
                       Text="{localization:Translate GoalWeightSectionHeaderLabel}" />

                <Label Grid.Row="1"
                       VerticalOptions="Center"
                       HorizontalOptions="Center"
                       Text="{Binding WeightProgress, StringFormat={localization:Translate PercentLabel}}" />
                <microcharts:ChartView Grid.Row="1"
                               BackgroundColor="Transparent"
                               Chart="{Binding WeightLeftChart}"/>

            <Label Grid.Row="2"
                       HorizontalOptions="Center">
                <Label.Triggers>
                    <DataTrigger TargetType="Label"
                                     Binding="{Binding SettingVals.Units}"
                                     Value="false">
                        <Setter Property="Text" Value="{Binding SettingVals.DistanceToGoalWeight, StringFormat={localization:Translate MetricWeightToGoLabel}}" />
                    </DataTrigger>
                    <DataTrigger TargetType="Label"
                                     Binding="{Binding SettingVals.Units}"
                                     Value="true">
                        <Setter Property="Text" Value="{Binding SettingVals.DistanceToGoalWeight, StringFormat={localization:Translate ImperialWeightToGoLabel}}" />
                    </DataTrigger>
                </Label.Triggers>
            </Label>
        </Grid>


        <!-- Weight Section -->

        <Grid  Grid.Column="1" Grid.Row="0" Margin="0" Padding="0" ColumnSpacing="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="15" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Label Grid.Column="0" Grid.Row="0"
                   HorizontalOptions="Center"
                   Text="{localization:Translate WeightLabel}"/>
            <Label Grid.Column="0" Grid.Row="1"
                       HorizontalOptions="Center"
                       Text="{Binding SettingVals.Weight}"/>
            <Label Grid.Column="1" Grid.Row="1"
                   HorizontalOptions="Start"
                   Margin="-20,0,0,0" 
                   FontSize="{StaticResource UnitFontSize}">
                <Label.Triggers>
                    <DataTrigger TargetType="Label"
                                     Binding="{Binding SettingVals.Units}"
                                     Value="false">
                        <Setter Property="Text" Value="{Binding SettingVals.GoalWeight, StringFormat={localization:Translate KiloGramsLabel}}" />
                    </DataTrigger>
                    <DataTrigger TargetType="Label"
                                     Binding="{Binding SettingVals.Units}"
                                     Value="true">
                        <Setter Property="Text" Value="{Binding SettingVals.GoalWeight, StringFormat={localization:Translate PoundsLabel}}" />
                    </DataTrigger>
                </Label.Triggers>
            </Label>
            <Label Grid.Column="0" Grid.Row="2"
                   HorizontalOptions="Center"
                   Text="{localization:Translate DayLabel}"/>
            <Label Grid.Column="0" Grid.Row="3"
                   HorizontalOptions="Center"
                   Text="{Binding CurrentDay}" />
            <Label Grid.Column="0" Grid.Row="4"
                   HorizontalOptions="Center"
                       Text="{localization:Translate GoalStatusLabel}"/>
            <Label Grid.Column="0" Grid.Row="5"
                   HorizontalOptions="Center"
                   FontSize="Small"
                   Text="{Binding ScheduleStatus}"/>
        </Grid>

        <!-- Days Left Chart Region -->
        <ContentView Grid.Column="2" Grid.Row="0" Margin="0" Padding="0" BackgroundColor="Transparent">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height=".14*" />
                    <RowDefinition Height=".74*" />
                    <RowDefinition Height=".14*" />
                </Grid.RowDefinitions>
                <Label Grid.Column="0" Grid.Row="0"
                       VerticalOptions="End"
                       HorizontalOptions="Center"
                       Text="{localization:Translate GoalDateSectionHeaderLabel}" />

                <Label Grid.Column="0" Grid.Row="1"
                       VerticalOptions="Center"
                       HorizontalOptions="Center"
                       Text="{Binding TimeProgress, StringFormat={localization:Translate PercentLabel}}" />
                <microcharts:ChartView Grid.Row="1"
                               BackgroundColor="Transparent"
                               Chart="{Binding DaysLeftChart}"/>

                <Label Grid.Column="0" Grid.Row="2"
                       HorizontalOptions="Center"
                       Text="{Binding SettingVals.TimeLeftToGoal, StringFormat={localization:Translate DaysToGoLabel}}" />
            </Grid>
        </ContentView>

        <!-- Add New Button -->
        <Button Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="3" HorizontalOptions="CenterAndExpand"
                Text="{localization:Translate AddEntryLabel}"
                Command="{Binding AddWeightToListCommand}"/>

        <!-- RDCI Section -->
        <Grid Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="3" Margin="0" Padding="0" ColumnSpacing="0" RowSpacing="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="25" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="40" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>
            <Label Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="2"
                   FontSize="{StaticResource HeaderFourFontSize}"
                   HorizontalOptions="Center"
                       Text="{localization:Translate BMRLabel}"/>
            <Label Grid.Column="0" Grid.Row="1"
                       HorizontalOptions="Center"
                       FontSize="{StaticResource HeaderThreeFontSize}"
                       Text="{Binding SettingVals.RecommendedDailyCaloricIntake, StringFormat='{0:0} Cal/day'}}"/>

        </Grid>

        <!-- BMI Section -->
        <Grid  Grid.Column="0" Grid.Row="3" Grid.ColumnSpan="3" RowSpacing="0" Padding="0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition  Height=".15*"/>
                <RowDefinition  Height=".25*"/>
                <RowDefinition  Height=".4*"/>
                <RowDefinition  Height=".2*"/>
            </Grid.RowDefinitions>

            <Label Grid.Column="0" Grid.Row="0" Grid.ColumnSpan="4"
                   HorizontalOptions="Center"
                   FontSize="{StaticResource HeaderFourFontSize}"
                   Text="{localization:Translate BMILabel}" />

            <Label Grid.Column="0" Grid.Row="1" Grid.ColumnSpan="2"
                   HorizontalOptions="Center"
               FontSize="{StaticResource HeaderThreeFontSize}"
               Text="{Binding SettingVals.BMI, StringFormat='{0:0.0}'}"/>

            <Label Grid.Column="2" Grid.Row="1" Grid.ColumnSpan="2"
                   HorizontalOptions="Center"
               FontSize="{StaticResource HeaderThreeFontSize}"
               Text="{Binding SettingVals.BMICategory}"/>

            <linear:SfLinearGauge Grid.Column="0" Grid.Row="2" Grid.ColumnSpan="4" Margin="0,0,0,0">
                <linear:SfLinearGauge.Scales>
                    <linear:LinearScale x:Name="scale" MinimumValue="10" MaximumValue="40"
                                    Interval="5" ScaleBarLength="100"
                                    ScaleBarColor="#FAECEC" MinorTicksPerInterval="1"
                                    ScaleBarSize="13" ScalePosition="BackWard" 
                                            LabelColor="{StaticResource primary_text}">
                        <linear:LinearScale.Ranges>
                            <linear:LinearRange StartValue="10" Color="#ea4c89" Offset ="0.07" EndValue="18.5" StartWidth="10" EndWidth="10"/>
                            <linear:LinearRange StartValue="18.5" Color="#00c300" EndValue="24.9" Offset ="0.07" StartWidth="10" EndWidth="10" />
                            <linear:LinearRange StartValue="25" Color="#ff5700" EndValue="29.9" Offset ="0.07" StartWidth="10" EndWidth="10" />
                            <linear:LinearRange StartValue="30" Color="#b92b27" EndValue="40" Offset ="0.07" StartWidth="10" EndWidth="10" />
                        </linear:LinearScale.Ranges>
                        <linear:LinearScale.Pointers>
                            <linear:SymbolPointer x:Name="symbolPointer" Value="{Binding SettingVals.BMI}"  Offset="0" Thickness="10" Color="{StaticResource primary_dark}" EnableAnimation="True"/>
                            <linear:BarPointer x:Name="rangePointer" Value="{Binding SettingVals.BMI}"  Thickness="10" EnableAnimation="True" Color="{StaticResource primary_dark}"/>
                        </linear:LinearScale.Pointers>
                    </linear:LinearScale>
                </linear:SfLinearGauge.Scales>
            </linear:SfLinearGauge>

            <Label Grid.Row="3" Grid.Column="0" Grid.ColumnSpan="2"
                   Margin="10,0,0,0" LineBreakMode="NoWrap"
                    FontSize="{StaticResource GraphLabelFontSize}"
                   TextColor="#ea4c89"
                           Text="{localization:Translate UnderWeightLabel}"/>
            <Label Grid.Row="3" Grid.Column="1"
                   FontSize="{StaticResource GraphLabelFontSize}"
                   TextColor="#00c300"
                   Margin="15,0,0,0"
                           Text="{localization:Translate NormalWeightLabel}" />
            <Label Grid.Row="3" Grid.Column="2"
                   FontSize="{StaticResource GraphLabelFontSize}"
                   TextColor="#ff5700"
                   Margin="-5,0,0,0"
                           Text="{localization:Translate OverweightLabel}"/>
            <Label Grid.Row="3" Grid.Column="3"
                   FontSize="{StaticResource GraphLabelFontSize}"
                   TextColor="#b92b27"
                   Margin="0,0,0,0"
                           Text="{localization:Translate ObeseLabel}" />
        </Grid>


        <!-- ADMOB Banner -->
        <controls:AdMobView Grid.Column="0" Grid.Row="4" Grid.ColumnSpan="3" VerticalOptions="End" />
    </Grid>

</ContentPage>